{% extends 'base.html.twig' %}

{% block body %}
<h1>Dashboard Global MIDDO</h1>

<p>
    Vue unifiÃ©e : Achats, Transport, Banque, Juridique.
</p>

<hr>

<h2>ğŸ›’ Centre dâ€™Achat â€” Commandes rÃ©centes</h2>
<table class="table">
    <thead>
        <tr>
            <th>ID</th>
            <th>Groupe</th>
            <th>Total</th>
            <th>Status</th>
            <th>Vue client</th>
        </tr>
    </thead>
    <tbody>
        {% for o in orders|slice(0,10) %}
            <tr>
                <td>{{ o.id }}</td>
                <td>{{ o.group.productName ?? 'â€”' }}</td>
                <td>{{ o.totalPrice }} â‚¬</td>
                <td>{{ o.status ?? 'â€”' }}</td>
                <td>
                    <a href="{{ path('client_order_view', {id: o.id}) }}" class="btn btn-sm btn-info">
                        DÃ©tails
                    </a>
                </td>
            </tr>
        {% endfor %}
    </tbody>
</table>

<hr>

<h2>ğŸšš Transport â€” Livraisons & segments</h2>
<div class="row">
    <div class="col-md-6">
        <h3>Livraisons</h3>
        <ul>
            {% for d in deliveries|slice(0,10) %}
                <li>
                    #{{ d.id }} â€” {{ d.pickupLocation }} â†’ {{ d.dropLocation }} ({{ d.status }})
                    â€” <a href="/track/{{ d.publicTrackingCode }}">Suivi public</a>
                </li>
            {% endfor %}
        </ul>
    </div>
    <div class="col-md-6">
        <h3>Segments rÃ©cents</h3>
        <ul>
            {% for s in segments|slice(0,10) %}
                <li>
                    Segment #{{ s.id }} â€” {{ s.fromLocation }} â†’ {{ s.toLocation }}
                    â€” {{ s.mode }} â€” {{ s.status }} â€” {{ s.segmentPrice }} â‚¬
                </li>
            {% endfor %}
        </ul>
    </div>
</div>

<hr>

<h2>ğŸ¦ Banque â€” Transactions rÃ©centes</h2>
<table class="table">
    <thead>
        <tr>
            <th>ID</th>
            <th>Type</th>
            <th>Montant</th>
            <th>Status</th>
            <th>RÃ©fÃ©rence</th>
            <th>Date</th>
        </tr>
    </thead>
    <tbody>
        {% for t in transactions|slice(0,10) %}
            <tr>
                <td>{{ t.id }}</td>
                <td>{{ t.type }}</td>
                <td>{{ t.amount }} â‚¬</td>
                <td>{{ t.status }}</td>
                <td>{{ t.referenceType }} #{{ t.referenceId }}</td>
                <td>{{ t.createdAt|date('d/m/Y H:i') }}</td>
            </tr>
        {% endfor %}
    </tbody>
</table>

<hr>

<h2>âš–ï¸ Juridique â€” Contrats logistiques</h2>
<table class="table">
    <thead>
        <tr>
            <th>ID</th>
            <th>Segment</th>
            <th>Status</th>
            <th>Date</th>
            <th>Voir</th>
        </tr>
    </thead>
    <tbody>
        {% for c in contracts|slice(0,10) %}
            <tr>
                <td>{{ c.id }}</td>
                <td>Segment #{{ c.segment.id }}</td>
                <td>{{ c.status }}</td>
                <td>{{ c.createdAt|date('d/m/Y H:i') }}</td>
                <td>
                    <a href="{{ path('logistic_contract_show', {id: c.segment.id}) }}" class="btn btn-sm btn-info">
                        Contrat
                    </a>
                </td>
            </tr>
        {% endfor %}
    </tbody>
</table>

<hr>

<h2>ğŸ§© Liens rapides</h2>
<ul>
    <li><a href="{{ path('transport_dashboard') }}">Dashboard Transport</a></li>
    <li><a href="{{ path('bank_dashboard') }}">Dashboard Banque</a></li>
    <li><a href="{{ path('legal_dashboard') }}">Dashboard Juridique</a></li>
</ul>

{% endblock %}
